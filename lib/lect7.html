
<!DOCTYPE html>
<html lang="bg">
<head>
    <title>Често срещани типажи, итератори и анонимни функции</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="rust,fmi">
    <link rel="stylesheet" href="resources/codeblock/codeblock.css">
<link rel="stylesheet" href="resources/frontend/controls.css">
<link rel="stylesheet" href="resources/global/global.css">
<link rel="stylesheet" href="resources/global/metadata.css">
<link rel="stylesheet" href="resources/highlight/hljs-github.css">
<link rel="stylesheet" href="resources/highlight/style.css">
<link rel="stylesheet" href="resources/highlight/tshl-github.css">
<link rel="stylesheet" href="resources/katex/katex.min.css">
<link rel="stylesheet" href="resources/rustc/rustc.css">
<link rel="stylesheet" href="resources/splitview/splitview.css">
<link rel="stylesheet" href="resources/wrapping-pages/wrapping-pages.css">
<script type="text/javascript" src="resources/codeblock/codeblock.js"></script>
<script type="text/javascript" src="resources/frontend/controls.js"></script>
</head>
<body>
    <main>
        <div class="slide">
<h1 id="често-срещани-типажи-итератори-и-анонимни-функции">Често срещани типажи, итератори и анонимни функции</h1>
<h3 id="4-ноември-2021">4 ноември 2021</h3>
</div><div class="slide">
<h1 id="често-използвани-типажи">Често използвани типажи</h1>
</div><div class="slide subslide">
<h1 id="често-използвани-типажи">Често използвани типажи</h1>
<p>Стандартната библиотека дефинира често използвани типажи</p>
</div><div class="slide subslide">
<h1 id="често-използвани-типажи">Често използвани типажи</h1>
<p>Стандартната библиотека дефинира често използвани типажи<br />
Голяма част от Rust екосистемата разчита на тях</p>
</div><div class="slide subslide">
<h1 id="често-използвани-типажи">Често използвани типажи</h1>
<p>Стандартната библиотека дефинира често използвани типажи<br />
Голяма част от Rust екосистемата разчита на тях<br />
Само ние можем да имплементираме стандартните trait-ове за наши типове</p>
</div><div class="slide subslide">
<h1 id="често-използвани-типажи">Често използвани типажи</h1>
<p>Стандартната библиотека дефинира често използвани типажи<br />
Голяма част от Rust екосистемата разчита на тях<br />
Само ние можем да имплементираме стандартните trait-ове за наши типове<br />
Затова, ако пишем библиотека, е добре да имплементираме всички стандартни trait-ове, които можем</p>
</div><div class="slide">
<h1 id="често-използвани-типажи">Често използвани типажи</h1>
<h3 id="списък">Списък</h3>
<ul>
<li>Copy</li>
<li>Clone</li>
<li>Eq</li>
<li>PartialEq</li>
<li>Ord</li>
<li>PartialOrd</li>
<li>Hash</li>
<li>Debug</li>
<li>Display</li>
<li>Default</li>
</ul>
</div><div class="slide">
<h1 id="clone">Clone</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Clone</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone_from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">source</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="clone">Clone</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Clone</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone_from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">source</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Създава копие на обекта</li>
</ul>
</div><div class="slide subslide">
<h1 id="clone">Clone</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Clone</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone_from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">source</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Създава копие на обекта</li>
<li>Позволява да си дефинираме собствена логика за копирането</li>
</ul>
</div><div class="slide subslide">
<h1 id="clone">Clone</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Clone</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone_from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">source</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Създава копие на обекта</li>
<li>Позволява да си дефинираме собствена логика за копирането</li>
<li>Поддържа <code>#[derive(Clone)]</code>, ако всички полета имплементират <code>Clone</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="clone">Clone</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Clone</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone_from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">source</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Създава копие на обекта</li>
<li>Позволява да си дефинираме собствена логика за копирането</li>
<li>Поддържа <code>#[derive(Clone)]</code>, ако всички полета имплементират <code>Clone</code></li>
<li>Имплементацията от derive извиква <code>clone</code> на всички полета рекурсивно</li>
</ul>
</div><div class="slide subslide">
<h1 id="clone">Clone</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Clone</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">clone_from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">source</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Създава копие на обекта</li>
<li>Позволява да си дефинираме собствена логика за копирането</li>
<li>Поддържа <code>#[derive(Clone)]</code>, ако всички полета имплементират <code>Clone</code></li>
<li>Имплементацията от derive извиква <code>clone</code> на всички полета рекурсивно</li>
<li>Рядко ще се налага да правим ръчна имплементация на <code>Clone</code>, защото не работим с гола памет!</li>
</ul>
</div><div class="slide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
<li>Изисква <code>Clone</code> да е имплементиран за съответния тип.</li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
<li>Изисква <code>Clone</code> да е имплементиран за съответния тип.</li>
<li>Може да се добави с <code>#[derive(Copy)]</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
<li>Изисква <code>Clone</code> да е имплементиран за съответния тип.</li>
<li>Може да се добави с <code>#[derive(Copy)]</code></li>
<li>Или като цяло с <code>Clone</code> - <code>#[derive(Copy, Clone)]</code>, поредността няма значение</li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
<li>Изисква <code>Clone</code> да е имплементиран за съответния тип.</li>
<li>Може да се добави с <code>#[derive(Copy)]</code></li>
<li>Или като цяло с <code>Clone</code> - <code>#[derive(Copy, Clone)]</code>, поредността няма значение</li>
</ul>
<p>Можем да имплементираме Copy само ако:</p>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
<li>Изисква <code>Clone</code> да е имплементиран за съответния тип.</li>
<li>Може да се добави с <code>#[derive(Copy)]</code></li>
<li>Или като цяло с <code>Clone</code> - <code>#[derive(Copy, Clone)]</code>, поредността няма значение</li>
</ul>
<p>Можем да имплементираме Copy само ако:</p>
<ul>
<li>всички полета са <code>Copy</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="copy">Copy</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Copy</span>: <span class="tshl-type">Clone</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Показва, че стойността може да се копира чрез копиране на паметта байт по байт т.е. <code>memcopy</code></li>
<li>Променя се семантиката за присвояване на стойност от преместване (move) на копиране (copy)</li>
<li>Изисква <code>Clone</code> да е имплементиран за съответния тип.</li>
<li>Може да се добави с <code>#[derive(Copy)]</code></li>
<li>Или като цяло с <code>Clone</code> - <code>#[derive(Copy, Clone)]</code>, поредността няма значение</li>
</ul>
<p>Можем да имплементираме Copy само ако:</p>
<ul>
<li>всички полета са <code>Copy</code></li>
<li>типа няма дефиниран деструктор (т.е. не е <code>Drop</code>)</li>
</ul>
</div><div class="slide">
<h1 id="drop">Drop</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">pub</span> <span class="tshl-keyword">trait</span> <span class="tshl-type">Drop</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">drop</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="drop">Drop</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">pub</span> <span class="tshl-keyword">trait</span> <span class="tshl-type">Drop</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">drop</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява да дефинираме деструктори</li>
</ul>
</div><div class="slide subslide">
<h1 id="drop">Drop</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">pub</span> <span class="tshl-keyword">trait</span> <span class="tshl-type">Drop</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">drop</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява да дефинираме деструктори</li>
<li>Метода се извиква автоматично, когато обекта излезе от scope</li>
</ul>
</div><div class="slide subslide">
<h1 id="drop">Drop</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">pub</span> <span class="tshl-keyword">trait</span> <span class="tshl-type">Drop</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">drop</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява да дефинираме деструктори</li>
<li>Метода се извиква автоматично, когато обекта излезе от scope</li>
<li>Не може да се извика ръчно</li>
</ul>
</div><div class="slide subslide">
<h1 id="drop">Drop</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">pub</span> <span class="tshl-keyword">trait</span> <span class="tshl-type">Drop</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">drop</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява да дефинираме деструктори</li>
<li>Метода се извиква автоматично, когато обекта излезе от scope</li>
<li>Не може да се извика ръчно</li>
<li>Вика се <code>drop</code> на всяко поле рекурсивно, ако имплементира <code>Drop</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="drop">Drop</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">pub</span> <span class="tshl-keyword">trait</span> <span class="tshl-type">Drop</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">drop</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява да дефинираме деструктори</li>
<li>Метода се извиква автоматично, когато обекта излезе от scope</li>
<li>Не може да се извика ръчно</li>
<li>Вика се <code>drop</code> на всяко поле рекурсивно, ако имплементира <code>Drop</code></li>
<li>Можем да използваме <code>std::mem::drop</code> за да "накараме" drop-ване (просто move-ва стойността в себе си и приключва)</li>
</ul>
</div><div class="slide">
<h1 id="default">Default</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Default</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">default</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="default">Default</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Default</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">default</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява създаване на обект със стойност по подразбиране</li>
</ul>
</div><div class="slide subslide">
<h1 id="default">Default</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Default</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">default</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява създаване на обект със стойност по подразбиране</li>
<li>Може да се добави с <code>#[derive(Default)]</code>, ако всички полета имплементират <code>Default</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="default">Default</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Default</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">default</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява създаване на обект със стойност по подразбиране</li>
<li>Може да се добави с <code>#[derive(Default)]</code>, ако всички полета имплементират <code>Default</code></li>
<li>Q: <code>Default</code> или <code>fn new() -&gt; Self</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="default">Default</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Default</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">default</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Позволява създаване на обект със стойност по подразбиране</li>
<li>Може да се добави с <code>#[derive(Default)]</code>, ако всички полета имплементират <code>Default</code></li>
<li>Q: <code>Default</code> или <code>fn new() -&gt; Self</code></li>
<li>A: и двете</li>
</ul>
</div><div class="slide">
<h1 id="hash">Hash</h1>
</div><div class="slide subslide">
<h1 id="hash">Hash</h1>
<ul>
<li>Използва се от типове и функции, които използват хеширане</li>
</ul>
</div><div class="slide subslide">
<h1 id="hash">Hash</h1>
<ul>
<li>Използва се от типове и функции, които използват хеширане</li>
<li>Например ключовете на <code>HashMap</code> и <code>HashSet</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="hash">Hash</h1>
<ul>
<li>Използва се от типове и функции, които използват хеширане</li>
<li>Например ключовете на <code>HashMap</code> и <code>HashSet</code></li>
<li>Може да се добави с <code>#[derive(Hash)]</code>, ако всички полета имплементират <code>Hash</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="hash">Hash</h1>
<ul>
<li>Използва се от типове и функции, които използват хеширане</li>
<li>Например ключовете на <code>HashMap</code> и <code>HashSet</code></li>
<li>Може да се добави с <code>#[derive(Hash)]</code>, ако всички полета имплементират <code>Hash</code></li>
<li>Няма да показваме ръчна имплементация</li>
</ul>
</div><div class="slide">
<h1 id="display--debug">Display &amp; Debug</h1>
<p>Вече сме виждали <code>#[derive(Debug)]</code>, сега ще разгледаме как да си имлементираме собствени <code>Display</code> и <code>Debug</code><br />
Те ни позволяват <code>format!</code>, <code>println!</code> и подобни макроси да работят за наш тип</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="2bc5e2f905badf0a856385bbd962aeed0baad251">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">struct</span> <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-property">description</span>: <span class="tshl-type">String</span>,
    <span class="tshl-property">secrets</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">String</span><span class="tshl-punctuation_bracket">&gt;</span>,
    <span class="tshl-property">skills</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">String</span><span class="tshl-punctuation_bracket">&gt;</span>,
}

<span class="tshl-keyword">let</span> trick = <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-property">description</span>: <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Изчезваща монета&quot;</span><span class="tshl-punctuation_bracket">)</span>,
    <span class="tshl-property">secrets</span>: <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Монетата се прибира в ръкава&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span>,
    <span class="tshl-property">skills</span>: <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Бързи ръце&quot;</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Заблуда&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span>,
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, trick<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;===&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, trick<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">Магически трик "Изчезваща монета"
===
MagicTrick { description: "Изчезваща монета", secrets: ["Монетата се прибира в ръкава"], skills: ["Бързи ръце", "Заблуда"] }</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="2bc5e2f905badf0a856385bbd962aeed0baad251">use std::fmt::{self, Display, Formatter};
impl Display for MagicTrick {
fn fmt(&self, f: &mut Formatter) -> fmt::Result {
write!(f, "Магически трик {:?}", self.description)
}
}
#[derive(Debug)]
struct MagicTrick {
    description: String,
    secrets: Vec<String>,
    skills: Vec<String>,
}

fn main() {
let trick = MagicTrick {
    description: String::from("Изчезваща монета"),
    secrets: vec![String::from("Монетата се прибира в ръкава")],
    skills: vec![String::from("Бързи ръце"), String::from("Заблуда")],
};

println!("{}", trick);
println!("===");
println!("{:?}", trick);
}</pre>
</div><div class="slide">
<h1 id="display">Display</h1>
</div><div class="slide subslide">
<h1 id="display">Display</h1>
<ul>
<li>Използва се от placeholder-a <code>{}</code> за форматиране на стойност, която ще се показва на потребителя</li>
</ul>
</div><div class="slide subslide">
<h1 id="display">Display</h1>
<ul>
<li>Използва се от placeholder-a <code>{}</code> за форматиране на стойност, която ще се показва на потребителя</li>
<li>Не може да се derive-не за разлика от <code>Debug</code></li>
</ul>
</div><div class="slide">
<h1 id="display">Display</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="20dfca711504e906a4c0ecf67a64e332a296f683">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>fmt<span class="tshl-punctuation_delimiter">::</span>{<span class="tshl-keyword">self</span>, <span class="tshl-constructor">Display</span>, <span class="tshl-constructor">Formatter</span>}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">impl</span> <span class="tshl-type">Display</span> <span class="tshl-keyword">for</span> <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">fmt</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">f</span>: <span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-type">Formatter</span><span class="tshl-punctuation_bracket">)</span> -&gt; fmt<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Result</span> {
        <span class="tshl-function_macro">write</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span>f, <span class="tshl-string">&quot;Магически трик {:?}&quot;</span>, <span class="tshl-variable_builtin">self</span>.description<span class="tshl-punctuation_bracket">)</span>
    }
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="20dfca711504e906a4c0ecf67a64e332a296f683">#![allow(dead_code)]
struct MagicTrick { description: String }
fn main() {}
use std::fmt::{self, Display, Formatter};

impl Display for MagicTrick {
    fn fmt(&self, f: &mut Formatter) -> fmt::Result {
        write!(f, "Магически трик {:?}", self.description)
    }
}</pre>
</div><div class="slide">
<h1 id="display">Display</h1>
<p>Нека да разбием примера и да видим какво oзначават новите неща</p>
</div><div class="slide">
<h1 id="макрос-write">Макрос write</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">write</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span>f, <span class="tshl-string">&quot;Магически трик {:?}&quot;</span>, <span class="tshl-variable_builtin">self</span>.description<span class="tshl-punctuation_bracket">)</span></code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="макрос-write">Макрос write</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">write</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span>f, <span class="tshl-string">&quot;Магически трик {:?}&quot;</span>, <span class="tshl-variable_builtin">self</span>.description<span class="tshl-punctuation_bracket">)</span></code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Подобно на <code>print!</code> и <code>format!</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="макрос-write">Макрос write</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">write</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span>f, <span class="tshl-string">&quot;Магически трик {:?}&quot;</span>, <span class="tshl-variable_builtin">self</span>.description<span class="tshl-punctuation_bracket">)</span></code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Подобно на <code>print!</code> и <code>format!</code></li>
<li>Записва форматиран текст в структура, която имплементира <code>std::fmt::Write</code> или <code>std::io::Write</code></li>
</ul>
</div><div class="slide">
<h1 id="formatter-структура">Formatter структура</h1>
<ul>
<li>Записваме форматирания текст в нея</li>
</ul>
</div><div class="slide subslide">
<h1 id="formatter-структура">Formatter структура</h1>
<ul>
<li>Записваме форматирания текст в нея</li>
<li>Съдържа набор от полезни функции за форматира като <code>pad</code>, <code>precision</code>, <code>width</code>, <code>debug_struct</code> и други</li>
</ul>
</div><div class="slide subslide">
<h1 id="formatter-структура">Formatter структура</h1>
<ul>
<li>Записваме форматирания текст в нея</li>
<li>Съдържа набор от полезни функции за форматира като <code>pad</code>, <code>precision</code>, <code>width</code>, <code>debug_struct</code> и други</li>
<li>Не можем да я конструираме, стандартната библиотека ни я подава като извиква форматъра</li>
</ul>
</div><div class="slide">
<h1 id="display">Display</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="a2cfb2700b50e7d0594586545c91d85c55f8c9e8">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">struct</span> <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-property">description</span>: <span class="tshl-type">String</span>,
    <span class="tshl-property">secrets</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">String</span><span class="tshl-punctuation_bracket">&gt;</span>,
    <span class="tshl-property">skills</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">String</span><span class="tshl-punctuation_bracket">&gt;</span>,
}

<span class="tshl-keyword">let</span> trick = <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-property">description</span>: <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Изчезваща монета&quot;</span><span class="tshl-punctuation_bracket">)</span>,
    <span class="tshl-property">secrets</span>: <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Монетата се прибира в ръкава&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span>,
    <span class="tshl-property">skills</span>: <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Бързи ръце&quot;</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Заблуда&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span>,
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, trick<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">Магически трик "Изчезваща монета"</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="a2cfb2700b50e7d0594586545c91d85c55f8c9e8">#![allow(dead_code)]
use std::fmt::{self, Display, Formatter};
impl Display for MagicTrick {
fn fmt(&self, f: &mut Formatter) -> fmt::Result {
write!(f, "Магически трик {:?}", self.description)
}
}
struct MagicTrick {
    description: String,
    secrets: Vec<String>,
    skills: Vec<String>,
}

fn main() {
let trick = MagicTrick {
    description: String::from("Изчезваща монета"),
    secrets: vec![String::from("Монетата се прибира в ръкава")],
    skills: vec![String::from("Бързи ръце"), String::from("Заблуда")],
};

println!("{}", trick);
}</pre>
</div><div class="slide">
<h1 id="debug">Debug</h1>
</div><div class="slide subslide">
<h1 id="debug">Debug</h1>
<ul>
<li>Използва се от placeholder-a <code>{:?}</code> за форматиране на стойност, която ще се показва само с цел debug</li>
</ul>
</div><div class="slide subslide">
<h1 id="debug">Debug</h1>
<ul>
<li>Използва се от placeholder-a <code>{:?}</code> за форматиране на стойност, която ще се показва само с цел debug</li>
<li>Както знаете <code>#[derive(Debug)]</code> имплементира версия по подразбиране</li>
</ul>
</div><div class="slide">
<h1 id="debug">Debug</h1>
<p>Може да напишем и собствена имплементация</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="f80fe960c7f941f77eb591cd5f4da66d1bf93f56">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>fmt<span class="tshl-punctuation_delimiter">::</span>{<span class="tshl-keyword">self</span>, <span class="tshl-constructor">Debug</span>, <span class="tshl-constructor">Formatter</span>}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">impl</span> <span class="tshl-type">Debug</span> <span class="tshl-keyword">for</span> <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">fmt</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">f</span>: <span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-type">Formatter</span><span class="tshl-punctuation_bracket">)</span> -&gt; fmt<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Result</span> {
        <span class="tshl-function_macro">write</span><span class="tshl-function_macro">!</span> {
            f,
<span class="tshl-string">r#&quot;Трик</span>
<span class="tshl-string">Описание: {:?}</span>
<span class="tshl-string">Тайни: {:?}</span>
<span class="tshl-string">Умения: {:?}&quot;#</span>,
            <span class="tshl-variable_builtin">self</span>.description,
            <span class="tshl-variable_builtin">self</span>.secrets,
            <span class="tshl-variable_builtin">self</span>.skills
        }
    }
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="f80fe960c7f941f77eb591cd5f4da66d1bf93f56">#![allow(dead_code)]
fn main() {}
struct MagicTrick {
description: String,
secrets: Vec<String>,
skills: Vec<String>
}
use std::fmt::{self, Debug, Formatter};

impl Debug for MagicTrick {
    fn fmt(&self, f: &mut Formatter) -> fmt::Result {
        write! {
            f,
r#"Трик
Описание: {:?}
Тайни: {:?}
Умения: {:?}"#,
            self.description,
            self.secrets,
            self.skills
        }
    }
}</pre>
</div><div class="slide">
<h1 id="display--debug">Display &amp; Debug</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="2613e427180f0cbdbd830ae59cc57ff3fe761b3b">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">struct</span> <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-property">description</span>: <span class="tshl-type">String</span>,
    <span class="tshl-property">secrets</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">String</span><span class="tshl-punctuation_bracket">&gt;</span>,
    <span class="tshl-property">skills</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">String</span><span class="tshl-punctuation_bracket">&gt;</span>,
}

<span class="tshl-keyword">let</span> trick = <span class="tshl-type">MagicTrick</span> {
    <span class="tshl-property">description</span>: <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Изчезваща монета&quot;</span><span class="tshl-punctuation_bracket">)</span>,
    <span class="tshl-property">secrets</span>: <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Монетата се прибира в ръкава&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span>,
    <span class="tshl-property">skills</span>: <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Бързи ръце&quot;</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">String</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Заблуда&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span>,
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, trick<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;===&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, trick<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">Магически трик "Изчезваща монета"
===
Трик
Описание: "Изчезваща монета"
Тайни: ["Монетата се прибира в ръкава"]
Умения: ["Бързи ръце", "Заблуда"]</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="2613e427180f0cbdbd830ae59cc57ff3fe761b3b">#![allow(dead_code)]
use std::fmt::{self, Display, Debug, Formatter};
impl Display for MagicTrick {
fn fmt(&self, f: &mut Formatter) -> fmt::Result {
write!(f, "Магически трик {:?}", self.description)
}
}
impl Debug for MagicTrick {
fn fmt(&self, f: &mut Formatter) -> fmt::Result {
write! { f,
r#"Трик
Описание: {:?}
Тайни: {:?}
Умения: {:?}"#,
self.description, self.secrets, self.skills
}
}
}
struct MagicTrick {
    description: String,
    secrets: Vec<String>,
    skills: Vec<String>,
}

fn main() {
let trick = MagicTrick {
    description: String::from("Изчезваща монета"),
    secrets: vec![String::from("Монетата се прибира в ръкава")],
    skills: vec![String::from("Бързи ръце"), String::from("Заблуда")],
};

println!("{}", trick);
println!("===");
println!("{:?}", trick);
}</pre>
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<p>Операторите се дефинират с trait-ове</p>
<p>Видяхме trait-а Add, с който дефинираме оператора +</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Add</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">RHS</span> = <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">add</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">rhs</span>: <span class="tshl-type">RHS</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="примери">Примери</h3>
<ul>
<li><code>Add</code>, <code>Sub</code>, <code>Mul</code>, <code>Div</code>, <code>Rem</code></li>
<li><code>BitAnd</code>, <code>BitOr</code>, <code>BitXor</code>, <code>Shl</code>, <code>Shr</code></li>
<li><code>*Assign</code> (<code>AddAssign</code>, <code>SubAssign</code>, и т.н.)</li>
<li><code>Neg</code>, <code>Not</code></li>
<li><code>Index</code></li>
<li><code>IndexMut</code></li>
</ul>
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="partialeq">PartialEq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Rhs</span> = <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-keyword">where</span> <span class="tshl-type">Rhs</span>: ?<span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">eq</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">ne</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="partialeq">PartialEq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Rhs</span> = <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-keyword">where</span> <span class="tshl-type">Rhs</span>: ?<span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">eq</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">ne</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Дефинира операторите <code>==</code> и <code>!=</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="partialeq">PartialEq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Rhs</span> = <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-keyword">where</span> <span class="tshl-type">Rhs</span>: ?<span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">eq</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">ne</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Дефинира операторите <code>==</code> и <code>!=</code></li>
<li>Не е задължително <code>a == a</code> да върне <code>true</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="partialeq">PartialEq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Rhs</span> = <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-keyword">where</span> <span class="tshl-type">Rhs</span>: ?<span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">eq</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">ne</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Дефинира операторите <code>==</code> и <code>!=</code></li>
<li>Не е задължително <code>a == a</code> да върне <code>true</code></li>
<li><code>assert_eq!(::std::f64::NAN == ::std::f64::NAN, false);</code></li>
</ul>
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="eq">Eq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Eq</span>: <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> { }</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="eq">Eq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Eq</span>: <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
</ul>
</div><div class="slide subslide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="eq">Eq</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Eq</span>: <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> { }</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li>Marker trait</li>
<li>Задължава <code>a == a</code> да е <code>true</code></li>
</ul>
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="partialord">PartialOrd</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">PartialOrd</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Rhs</span> = <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">PartialEq</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-keyword">where</span> <span class="tshl-type">Rhs</span>: ?<span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">partial_cmp</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Option</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Ordering</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">lt</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
    <span class="tshl-keyword">fn</span> <span class="tshl-function">le</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
    <span class="tshl-keyword">fn</span> <span class="tshl-function">gt</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
    <span class="tshl-keyword">fn</span> <span class="tshl-function">ge</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Rhs</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">bool</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}

<span class="tshl-keyword">enum</span> <span class="tshl-type">Ordering</span> {
    <span class="tshl-constructor">Less</span>,
    <span class="tshl-constructor">Equal</span>,
    <span class="tshl-constructor">Greater</span>,
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="partialord">PartialOrd</h3>
<p>Дефинира операторите <code>&lt; &lt;= &gt; &gt;=</code></p>
<p>PartialOrd дефинира частична наредба</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="1373072ba57755b96a5ce64d1188db1ab545ea8f">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">assert_eq</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span>::std::<span class="tshl-type_builtin">f64</span>::<span class="tshl-constructor">NAN</span> &lt; <span class="tshl-constant_builtin">0.0</span>, <span class="tshl-constant_builtin">false</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">assert_eq</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span>::std::<span class="tshl-type_builtin">f64</span>::<span class="tshl-constructor">NAN</span> &gt;= <span class="tshl-constant_builtin">0.0</span>, <span class="tshl-constant_builtin">false</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="1373072ba57755b96a5ce64d1188db1ab545ea8f">fn main() {
assert_eq!(::std::f64::NAN < 0.0, false);
assert_eq!(::std::f64::NAN >= 0.0, false);
}</pre>
</div><div class="slide">
<h1 id="предефиниране-на-оператори">Предефиниране на оператори</h1>
<h3 id="ord">Ord</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Ord</span>: <span class="tshl-type">Eq</span> + <span class="tshl-type">PartialOrd</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">cmp</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Ordering</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">max</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
    <span class="tshl-keyword">fn</span> <span class="tshl-function">min</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">other</span>: <span class="tshl-type">Self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span> { ..<span class="tshl-punctuation_delimiter">.</span><span class="tshl-property"></span> }
}</code></pre>
                    </div>
                    
                </div>
                
<p>Дефинира тотална наредба т.е само едно от <code>a &lt; b</code>, <code>a == b</code>, <code>a &gt; b</code> е изпълнено.</p>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<p><img src="resources/iterator.jpeg" alt="" /></p>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<p>Итераторите имплементират trait, който изглежда така:</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="735ed769f133f2088cd0bc380b573eb3702dd4a3">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">Iterator</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Item</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">next</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Option</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Item</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-comment">// ... predefined iterator methods ...</span>
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="735ed769f133f2088cd0bc380b573eb3702dd4a3">#![allow(dead_code)]
fn main() {}
trait Iterator {
    type Item;

    fn next(&mut self) -> Option<Self::Item>;

    // ... predefined iterator methods ...
}</pre>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<p>Ето и как може да си имплементиране собствен итератор</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="72470aeb4fed6ccad850de1dadc92d08ff61d0d8">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">struct</span> <span class="tshl-type">OneTwoThree</span> {
    <span class="tshl-property">state</span>: <span class="tshl-type_builtin">u32</span>,
}

<span class="tshl-keyword">impl</span> <span class="tshl-type">OneTwoThree</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">new</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span> {
        <span class="tshl-type">Self</span> { <span class="tshl-property">state</span>: <span class="tshl-constant_builtin">0</span> }
    }
}

<span class="tshl-keyword">impl</span> <span class="tshl-type">Iterator</span> <span class="tshl-keyword">for</span> <span class="tshl-type">OneTwoThree</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Item</span> = <span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">next</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Option</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Item</span><span class="tshl-punctuation_bracket">&gt;</span> {
        <span class="tshl-keyword">if</span> <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-property">state</span> &lt; <span class="tshl-constant_builtin">3</span> {
            <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-property">state</span> += <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_delimiter">;</span>
            <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-property">state</span><span class="tshl-punctuation_bracket">)</span>
        } <span class="tshl-keyword">else</span> {
            <span class="tshl-constructor">None</span>
        }
    }
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="72470aeb4fed6ccad850de1dadc92d08ff61d0d8">#![allow(dead_code)]
fn main() {}
struct OneTwoThree {
    state: u32,
}

impl OneTwoThree {
    fn new() -> Self {
        Self { state: 0 }
    }
}

impl Iterator for OneTwoThree {
    type Item = u32;

    fn next(&mut self) -> Option<Self::Item> {
        if self.state < 3 {
            self.state += 1;
            Some(self.state)
        } else {
            None
        }
    }
}</pre>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="bd3e7874ac319ea4d4c3df69e271ff3bb0777685">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">main</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-keyword">let</span> <span class="tshl-keyword">mut</span> iter = <span class="tshl-type">OneTwoThree</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">new</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, iter.next<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, iter.next<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, iter.next<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, iter.next<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, iter.next<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-comment">// ...</span>
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">Some(1)
Some(2)
Some(3)
None
None</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="bd3e7874ac319ea4d4c3df69e271ff3bb0777685">#![allow(dead_code)]
struct OneTwoThree {
state: u32,
}
impl Iterator for OneTwoThree {
type Item = u32;
fn next(&mut self) -> Option<Self::Item> {
if self.state < 3 { self.state += 1 ; Some(self.state) } else { None }
}
}
impl OneTwoThree {
fn new() -> Self {
Self { state: 0 }
}
}
fn main() {
    let mut iter = OneTwoThree::new();

    println!("{:?}", iter.next());
    println!("{:?}", iter.next());
    println!("{:?}", iter.next());
    println!("{:?}", iter.next());
    println!("{:?}", iter.next());
    // ...
}</pre>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="intoiterator">IntoIterator</h3>
<p>Указва как може един тип да се конвертира до итератор.</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">IntoIterator</span>
{
    <span class="tshl-keyword">type</span> <span class="tshl-type">Item</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">type</span> <span class="tshl-type">IntoIter</span>: <span class="tshl-type">Iterator</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Item</span>=<span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Item</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">IntoIter</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="intoiterator">IntoIterator</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="f09e24e0b202472e0749fb93f6111d988125d87a">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> <span class="tshl-keyword">mut</span> iter = v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">while</span> <span class="tshl-keyword">let</span> <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span>i<span class="tshl-punctuation_bracket">)</span> = iter<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">next</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">1
2
3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="f09e24e0b202472e0749fb93f6111d988125d87a">#![allow(dead_code)]
fn main() {
let v = vec![1, 2, 3];
let mut iter = v.into_iter();

while let Some(i) = iter.next() {
    println!("{}", i);
}
}</pre>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="intoiterator">IntoIterator</h3>
<p>Също така получаваме и благото да използваме типа директно във <code>for-in</code> цикли</p>
<p>Тъй като векторите имплементират този типаж, следните два примера са еднакви</p>
<div class="split-view" markdown="1"><div class="lhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">1
2
3</div></pre></p>
<p><pre class="rustc-source" data-sha="d95cb8da6e0b87e6d44e2411507571bd43b344f6">#![allow(dead_code)]
fn main() {
let v = vec![1, 2, 3];

for i in v.into_iter() {
    println!("{}", i);
}
}</pre></p></div>
<div class="rhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> v {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">1
2
3</div></pre></p>
<p><pre class="rustc-source" data-sha="809c334f04a7c88e8ce267f351cb203881b9a37e">#![allow(dead_code)]
fn main() {
let v = vec![1, 2, 3];

for i in v {
    println!("{}", i);
}
}</pre></p></div></div>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="for-in-цикъл">for-in цикъл</h3>
<p>Нека отбележим и доста важен факт, че всеки итератор има имплементиран <code>IntoIterator</code></p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">impl</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">I</span>: <span class="tshl-type">Iterator</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-type">IntoIterator</span> <span class="tshl-keyword">for</span> <span class="tshl-type">I</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Item</span> = <span class="tshl-constructor">I</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Item</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">type</span> <span class="tshl-type">IntoIter</span> = <span class="tshl-type">I</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-keyword">fn</span> <span class="tshl-function">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">I</span> {
        <span class="tshl-variable_builtin">self</span>
    }
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="for-in-цикъл">for-in цикъл</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="8431b0048ab8961588cbaa8a0428656bb099b72e">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> values = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">for</span> x <span class="tshl-keyword">in</span> values {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, x<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">1
2
3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="8431b0048ab8961588cbaa8a0428656bb099b72e">#![allow(dead_code)]
fn main() {
let values = vec![1, 2, 3];

for x in values {
    println!("{}", x);
}
}</pre>
<p>Rust генерира следният код зад всеки <code>for-in</code> цикъл:</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="3c20dca51b294c3edeb798eaff9b970dd4b8d5ac">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> values = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
{
    <span class="tshl-keyword">let</span> result = <span class="tshl-keyword">match</span> <span class="tshl-type">IntoIterator</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">into_iter</span><span class="tshl-punctuation_bracket">(</span>values<span class="tshl-punctuation_bracket">)</span> {
        <span class="tshl-keyword">mut</span> iter =&gt; <span class="tshl-keyword">loop</span> {
            <span class="tshl-keyword">let</span> next<span class="tshl-punctuation_delimiter">;</span>
            <span class="tshl-keyword">match</span> iter<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">next</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
                <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span>val<span class="tshl-punctuation_bracket">)</span> =&gt; next = val,
                <span class="tshl-constructor">None</span> =&gt; <span class="tshl-keyword">break</span>,
            }<span class="tshl-punctuation_delimiter">;</span>
            <span class="tshl-keyword">let</span> x = next<span class="tshl-punctuation_delimiter">;</span>
            <span class="tshl-keyword">let</span> <span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> = { <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, x<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span> }<span class="tshl-punctuation_delimiter">;</span>
        },
    }<span class="tshl-punctuation_delimiter">;</span>
    result
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">1
2
3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="3c20dca51b294c3edeb798eaff9b970dd4b8d5ac">#![allow(dead_code)]
fn main() {
let values = vec![1, 2, 3];
{
    let result = match IntoIterator::into_iter(values) {
        mut iter => loop {
            let next;
            match iter.next() {
                Some(val) => next = val,
                None => break,
            };
            let x = next;
            let () = { println!("{}", x); };
        },
    };
    result
}
}</pre>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="fromiterator">FromIterator</h3>
<p>Обратно на <code>IntoIterator</code>, <code>FromIterator</code> се използва за да укаже как един итератор да се конвертира до тип, най-често структура от данни.</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">FromIterator</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">A</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">from_iter</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">T</span>: <span class="tshl-type">IntoIterator</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Item</span>=<span class="tshl-type">A</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">iter</span>: <span class="tshl-type">T</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="итератори">Итератори</h1>
<h3 id="fromiterator">FromIterator</h3>
<p>Обратно на <code>IntoIterator</code>, <code>FromIterator</code> се използва за да укаже как един итератор да се конвертира до тип, най-често структура от данни.</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">trait</span> <span class="tshl-type">FromIterator</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">A</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">Sized</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">from_iter</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">T</span>: <span class="tshl-type">IntoIterator</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Item</span>=<span class="tshl-type">A</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">iter</span>: <span class="tshl-type">T</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Self</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<p>Ще видим как това е полезно при итератор адаптeрите.</p>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="vec">Vec</h3>
<p>Има две интересни имплементации на <code>Iterator</code> за <code>Vec</code>, освен стандартната</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">impl</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">T</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-type">IntoIterator</span> <span class="tshl-keyword">for</span> <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">T</span><span class="tshl-punctuation_bracket">&gt;</span>

<span class="tshl-keyword">impl</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">a</span>, <span class="tshl-type">T</span><span class="tshl-punctuation_bracket">&gt;</span> <span class="tshl-constructor">IntoIterator</span> <span class="tshl-keyword">for</span> <span class="tshl-operator">&amp;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">a</span> <span class="tshl-keyword">mut</span> <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">T</span><span class="tshl-punctuation_bracket">&gt;</span>
<span class="tshl-keyword">impl</span>&lt;<span class="tshl-operator">&#39;</span><span class="tshl-label">a</span>, <span class="tshl-type">T</span>&gt; <span class="tshl-constructor">IntoIterator</span> <span class="tshl-keyword">for</span> <span class="tshl-operator">&amp;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">a</span> <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">T</span><span class="tshl-punctuation_bracket">&gt;</span></code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="vec">Vec</h3>
<p>които позволяват взаимно заменяемия код</p>
<div class="split-view" markdown="1"><div class="lhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">1
2
3</div></pre></p>
<p><pre class="rustc-source" data-sha="3e968d2e3b4a0c3ace92afc269ea29a9d836d7ed">fn main() {
let v = vec![1, 2, 3];
for i in v.iter() {
    println!("{}", i);
}
}</pre></p></div>
<div class="rhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> <span class="tshl-operator">&amp;</span>v {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">1
2
3</div></pre></p>
<p><pre class="rustc-source" data-sha="9807d2246e2f26a95355edd31e9fb2c700a0a713">fn main() {
let v = vec![1, 2, 3];
for i in &v {
    println!("{}", i);
}
}</pre></p></div></div>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="vec">Vec</h3>
<p>както и mutable версията</p>
<div class="split-view" markdown="1"><div class="lhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> <span class="tshl-keyword">mut</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">iter_mut</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-operator">*</span>i += <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_delimiter">;</span>
}
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, v<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">[2, 3, 4]</div></pre></p>
<p><pre class="rustc-source" data-sha="6f03894b35a9b794ac8e8e137c0991bede2dff66">fn main() {
let mut v = vec![1, 2, 3];
for i in v.iter_mut() {
    *i += 1;
}
println!("{:?}", v);
}</pre></p></div>
<div class="rhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> <span class="tshl-keyword">mut</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> <span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> v {
    <span class="tshl-operator">*</span>i += <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_delimiter">;</span>
}
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, v<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">[2, 3, 4]</div></pre></p>
<p><pre class="rustc-source" data-sha="f975a16410d650d4ad1db8b0e29424deeb370865">fn main() {
let mut v = vec![1, 2, 3];
for i in &mut v {
    *i += 1;
}
println!("{:?}", v);
}</pre></p></div></div>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>
<p><img src="resources/adapters.jpeg" alt="" /></p>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="352885efb9c1a2d6210bfca673c4ba2472dcf85b">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> iter = v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|x| x + <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">filter</span><span class="tshl-punctuation_bracket">(</span>|<span class="tshl-operator">&amp;</span>x| x &lt; <span class="tshl-constant_builtin">4</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> iter {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">2
3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="352885efb9c1a2d6210bfca673c4ba2472dcf85b">fn main() {
let v = vec![1, 2, 3];
let iter = v.into_iter().map(|x| x + 1).filter(|&x| x < 4);
for i in iter {
    println!("{}", i);
}
}</pre>
</div><div class="slide subslide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="352885efb9c1a2d6210bfca673c4ba2472dcf85b">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> iter = v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|x| x + <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">filter</span><span class="tshl-punctuation_bracket">(</span>|<span class="tshl-operator">&amp;</span>x| x &lt; <span class="tshl-constant_builtin">4</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> iter {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">2
3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="352885efb9c1a2d6210bfca673c4ba2472dcf85b">fn main() {
let v = vec![1, 2, 3];
let iter = v.into_iter().map(|x| x + 1).filter(|&x| x < 4);
for i in iter {
    println!("{}", i);
}
}</pre>
<ul>
<li>Това са функции които взимат итератор и връщат нов итератор.</li>
</ul>
</div><div class="slide subslide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="352885efb9c1a2d6210bfca673c4ba2472dcf85b">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> iter = v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|x| x + <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">filter</span><span class="tshl-punctuation_bracket">(</span>|<span class="tshl-operator">&amp;</span>x| x &lt; <span class="tshl-constant_builtin">4</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">for</span> i <span class="tshl-keyword">in</span> iter {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, i<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">2
3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="352885efb9c1a2d6210bfca673c4ba2472dcf85b">fn main() {
let v = vec![1, 2, 3];
let iter = v.into_iter().map(|x| x + 1).filter(|&x| x < 4);
for i in iter {
    println!("{}", i);
}
}</pre>
<ul>
<li>Това са функции които взимат итератор и връщат нов итератор.</li>
<li>Най-често правят трансформации на данните.</li>
</ul>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="db858dd15a4102f546f5e94e1114ce224fffbb60">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> v = v
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|x| x + <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span>
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">filter</span><span class="tshl-punctuation_bracket">(</span>|<span class="tshl-operator">&amp;</span>x| x &lt; <span class="tshl-constant_builtin">4</span><span class="tshl-punctuation_bracket">)</span>
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">collect</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">_</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, v<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">[2, 3]</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="db858dd15a4102f546f5e94e1114ce224fffbb60">fn main() {
let v = vec![1, 2, 3];
let v = v
    .into_iter()
    .map(|x| x + 1)
    .filter(|&x| x < 4)
    .collect::<Vec<_>>();

println!("{:?}", v);
}</pre>
</div><div class="slide subslide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="db858dd15a4102f546f5e94e1114ce224fffbb60">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> v = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> v = v
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|x| x + <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span>
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">filter</span><span class="tshl-punctuation_bracket">(</span>|<span class="tshl-operator">&amp;</span>x| x &lt; <span class="tshl-constant_builtin">4</span><span class="tshl-punctuation_bracket">)</span>
    <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">collect</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">_</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, v<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">[2, 3]</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="db858dd15a4102f546f5e94e1114ce224fffbb60">fn main() {
let v = vec![1, 2, 3];
let v = v
    .into_iter()
    .map(|x| x + 1)
    .filter(|&x| x < 4)
    .collect::<Vec<_>>();

println!("{:?}", v);
}</pre>
<p>Това е възможно, защото <code>collect</code> извиква <code>FromIterator::from_iter</code>.</p>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<p>Има някои интересни имплементации на <code>FromIterator</code>.<br />
Например връщане на единичен резултат от итеаратор с резултати:</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="0c7816452be93f4f0969bb422dbe8733e3f32fbe">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">batch</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">v</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Result</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type_builtin">u32</span>, <span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Result</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">&gt;</span>, <span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">&gt;</span> {
    v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">collect</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
}

<span class="tshl-keyword">fn</span> <span class="tshl-function">only_err</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">v</span>: <span class="tshl-type">Vec</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Result</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Result</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">&gt;</span> {
    v<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">collect</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
}

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, batch<span class="tshl-punctuation_bracket">(</span>vec!<span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">2</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, batch<span class="tshl-punctuation_bracket">(</span>vec!<span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Err</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">2</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Err</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, only_err<span class="tshl-punctuation_bracket">(</span>vec!<span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, only_err<span class="tshl-punctuation_bracket">(</span>vec!<span class="tshl-punctuation_bracket">[</span><span class="tshl-constructor">Ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Err</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">Err</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">2</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">Ok([1, 2, 3])
Err(2)

Ok(())
Err(1)</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="0c7816452be93f4f0969bb422dbe8733e3f32fbe">fn batch(v: Vec<Result<u32, u32>>) -> Result<Vec<u32>, u32> {
    v.into_iter().collect()
}

fn only_err(v: Vec<Result<(), u32>>) -> Result<(), u32> {
    v.into_iter().collect()
}

fn main() {
println!("{:?}", batch(vec![Ok(1), Ok(2), Ok(3)]));
println!("{:?}", batch(vec![Ok(1), Err(2), Err(3)]));
println!();
println!("{:?}", only_err(vec![Ok(()), Ok(()), Ok(())]));
println!("{:?}", only_err(vec![Ok(()), Err(1), Err(2)]));
}</pre>
</div><div class="slide">
<h1 id="итератори">Итератори</h1>
<h3 id="адаптери">Адаптери</h3>
<p>Преди да правите сложни цикли за трансформация, разгледайте <code>Iterator</code>, <code>FromIterator</code> и <code>IntoIterator</code>.</p>
</div><div class="slide">
<h1 id="closures">Closures</h1>
<p><img src="resources/closure.jpg" alt="" /></p>
</div><div class="slide">
<h1 id="closures">Closures</h1>
<h3 id="syntax">syntax</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs">|<span class="tshl-variable_parameter">x</span>: <span class="tshl-type_builtin">u32</span>| -&gt; <span class="tshl-type_builtin">u32</span> { x + <span class="tshl-constant_builtin">1</span> }
|x| { x + <span class="tshl-constant_builtin">1</span> }
|x| x + <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_delimiter"></span></code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="closure-vs-fn">Closure vs fn</h1>
<p>Каква е разликата между функция и closure?</p>
<p>Closures могат да използват променливи дефинирани по-горе в scope-a.</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="ff81f3aacdc41f715cef8bb473be0e7c21accc5b">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">main</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-keyword">let</span> other = <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;foo&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>               <span class="tshl-comment">// &lt;-+</span>
                                                   <span class="tshl-comment">//   |</span>
    <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;bar&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|s| s<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + other<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>    <span class="tshl-comment">// --+</span>
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="ff81f3aacdc41f715cef8bb473be0e7c21accc5b">fn main() {
    let other = String::from("foo");               // <-+
                                                   //   |
    Some("bar").map(|s| s.len() + other.len());    // --+
}</pre>
</div><div class="slide">
<h1 id="вътрешна-имплементация">Вътрешна имплементация</h1>
<p>Зад кулисите компилаторът създава една структура и една функция</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="e8321ef4b59e477aa5c01115b5e4e0e9f1d54a36">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">/// Структура в която запомняме променливите, които сме прихванали</span>
<span class="tshl-keyword">struct</span> <span class="tshl-type">State</span> {
    <span class="tshl-property">other</span>: <span class="tshl-type">String</span>,
}

<span class="tshl-keyword">impl</span> <span class="tshl-type">State</span> {
    <span class="tshl-comment">/// Функция която съдържа логиката</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">s</span>: <span class="tshl-operator">&amp;</span><span class="tshl-type_builtin">str</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> {
        s<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + <span class="tshl-variable_builtin">self</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-property">other</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
    }
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="e8321ef4b59e477aa5c01115b5e4e0e9f1d54a36">#![allow(dead_code)]
fn main() {}
/// Структура в която запомняме променливите, които сме прихванали
struct State {
    other: String,
}

impl State {
    /// Функция която съдържа логиката
    fn call(&self, s: &str) -> usize {
        s.len() + self.other.len()
    }
}</pre>
</div><div class="slide">
<h1 id="вътрешна-имплементация">Вътрешна имплементация</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="516eb4961bc80798f9c7520a665f73aee60ea0cf">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">map_option</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">opt</span>: <span class="tshl-type">Option</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-operator">&amp;</span><span class="tshl-type_builtin">str</span><span class="tshl-punctuation_bracket">&gt;</span>, <span class="tshl-variable_parameter">f</span>: <span class="tshl-type">State</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type">Option</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type_builtin">usize</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">match</span> opt {
        <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span>s<span class="tshl-punctuation_bracket">)</span> =&gt; <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span>f<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">call</span><span class="tshl-punctuation_bracket">(</span>s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span>,
        <span class="tshl-constructor">None</span> =&gt; <span class="tshl-constructor">None</span>,
    }
}

<span class="tshl-keyword">fn</span> <span class="tshl-function">main</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-keyword">let</span> other = <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;foo&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-function">map_option</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;bar&quot;</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-type">State</span> { other }<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="516eb4961bc80798f9c7520a665f73aee60ea0cf">#![allow(dead_code)]
struct State {
other: String,
}
impl State {
fn call(&self, s: &str) -> usize {
s.len() + self.other.len()
}
}
fn map_option(opt: Option<&str>, f: State) -> Option<usize> {
    match opt {
        Some(s) => Some(f.call(s)),
        None => None,
    }
}

fn main() {
    let other = String::from("foo");

    map_option(Some("bar"), State { other });
}</pre>
</div><div class="slide">
<h1 id="move-closure">Move closure</h1>
<p>Closure-ите, за разлика от нашата имплементация, не консумират прихванатите променливи по подразбиране</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="d5d20d1bb3b1ed7ace01961d4c3284f6c59e15d1">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> other = <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;foo&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, <span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;bar&quot;</span><span class="tshl-punctuation_bracket">)</span>.map<span class="tshl-punctuation_bracket">(</span>|s| s.len<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + other.len<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, other<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>       <span class="tshl-comment">// Ок</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, map_option<span class="tshl-punctuation_bracket">(</span><span class="tshl-constructor">Some</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;bar&quot;</span><span class="tshl-punctuation_bracket">)</span>, <span class="tshl-constructor">State</span> { other }<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-comment">// println!(&quot;{:?}&quot;, other);    // комп. грешка - use of moved value `other`</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">Some(6)
"foo"
Some(6)</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="d5d20d1bb3b1ed7ace01961d4c3284f6c59e15d1">#![allow(dead_code)]
struct State {
other: String,
}
impl State {
fn call(&self, s: &str) -> usize {
s.len() + self.other.len()
}
}
fn map_option(opt: Option<&str>, f: State) -> Option<usize> {
match opt {
Some(s) => Some(f.call(s)),
None => None,
}
}
fn main() {
let other = String::from("foo");

println!("{:?}", Some("bar").map(|s| s.len() + other.len()));
println!("{:?}", other);       // Ок

println!("{:?}", map_option(Some("bar"), State { other }));
// println!("{:?}", other);    // комп. грешка - use of moved value `other`
}</pre>
</div><div class="slide">
<h1 id="move-closure">Move closure</h1>
<p>Можем да променим семантиката с ключовата дума move</p>
<div class="split-view" markdown="1"><div class="lhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs">|s| s<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + other<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-comment">// генерира</span>
<span class="tshl-keyword">struct</span> <span class="tshl-type">State</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">a</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-property">other</span>: <span class="tshl-operator">&amp;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">a</span> <span class="tshl-type">String</span>
}</code></pre>
                    </div>
                    
                </div>
                </p></div>
<div class="rhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">move</span> |s| s<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + other<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">len</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-comment">// генерира</span>
<span class="tshl-keyword">struct</span> <span class="tshl-type">State</span> {
    <span class="tshl-property">other</span>: <span class="tshl-type">String</span>
}</code></pre>
                    </div>
                    
                </div>
                </p></div></div>
</div><div class="slide">
<h1 id="move-closure">Move closure</h1>
<p><code>move</code> премества стойността, независимо как се използва</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="f6044e6c5f86803cf8de5bd1c9534fdf25089833">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> nums = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span>, <span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-comment">// прихваща `nums` като `Vec&lt;i32&gt;`</span>
<span class="tshl-keyword">let</span> f = <span class="tshl-keyword">move</span> || {
    <span class="tshl-keyword">for</span> n <span class="tshl-keyword">in</span> <span class="tshl-operator">&amp;</span>nums {
        <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, n<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    }
}<span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="f6044e6c5f86803cf8de5bd1c9534fdf25089833">fn main() {
let nums = vec![0, 1, 2, 3];

// прихваща `nums` като `Vec<i32>`
let f = move || {
    for n in &nums {
        println!("{}", n);
    }
};
}</pre>
</div><div class="slide">
<h1 id="move-closure">Move closure</h1>
<p>Ако искаме да преместим някоя стойност, но да прихванем друга по референция:</p>
<div class="split-view" markdown="1"><div class="lhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> nums = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span>, <span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> s = <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;cookies&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> f = || {
    <span class="tshl-comment">// move `nums`</span>
    <span class="tshl-keyword">let</span> nums = nums<span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, nums<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">"cookies"</div></pre></p>
<p><pre class="rustc-source" data-sha="8ce3a94204e1d61845393972afee0292b170dbd6">fn main() {
let nums = vec![0, 1, 2, 3];
let s = String::from("cookies");

let f = || {
    // move `nums`
    let nums = nums;

    println!("{:?}", nums);
    println!("{:?}", s);
};

println!("{:?}", s);
}</pre></p></div>
<div class="rhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> nums = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span>, <span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> s = <span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;cookies&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> f = || {
    <span class="tshl-comment">// move `nums`</span>
    <span class="tshl-keyword">let</span> nums = nums<span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, nums<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, nums<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs"><span style="font-weight:bold;color:rgb(255,85,85)">error[E0382]</span><span style="font-weight:bold">: borrow of moved value: `nums`</span>
  <span style="font-weight:bold;color:rgb(85,85,255)">--&gt; </span>src/bin/main_81dc119f3e90ee303c7ebd23dc742d4904615a0d.rs:13:18
   <span style="font-weight:bold;color:rgb(85,85,255)">|</span>
<span style="font-weight:bold;color:rgb(85,85,255)">2</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>let nums = vec![0, 1, 2, 3];
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>    <span style="font-weight:bold;color:rgb(85,85,255)">----</span> <span style="font-weight:bold;color:rgb(85,85,255)">move occurs because `nums` has type `Vec&lt;i32&gt;`, which does not implement the `Copy` trait</span>
<span style="font-weight:bold;color:rgb(85,85,255)">...</span>
<span style="font-weight:bold;color:rgb(85,85,255)">5</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>let f = || {
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>        <span style="font-weight:bold;color:rgb(85,85,255)">--</span> <span style="font-weight:bold;color:rgb(85,85,255)">value moved into closure here</span>
<span style="font-weight:bold;color:rgb(85,85,255)">6</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>    // move `nums`
<span style="font-weight:bold;color:rgb(85,85,255)">7</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>    let nums = nums;
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>               <span style="font-weight:bold;color:rgb(85,85,255)">----</span> <span style="font-weight:bold;color:rgb(85,85,255)">variable moved due to use in closure</span>
<span style="font-weight:bold;color:rgb(85,85,255)">...</span>
<span style="font-weight:bold;color:rgb(85,85,255)">13</span> <span style="font-weight:bold;color:rgb(85,85,255)">| </span>println!("{:?}", nums);
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>                 <span style="font-weight:bold;color:rgb(255,85,85)">^^^^</span> <span style="font-weight:bold;color:rgb(255,85,85)">value borrowed here after move</span>

<span style="font-weight:bold">For more information about this error, try `rustc --explain E0382`.</span>
<span style="font-weight:bold;color:rgb(255,85,85)">error</span><span style="font-weight:bold">:</span> could not compile `rust` due to previous error</div></pre></p>
<p><pre class="rustc-source" data-sha="81dc119f3e90ee303c7ebd23dc742d4904615a0d">fn main() {
let nums = vec![0, 1, 2, 3];
let s = String::from("cookies");

let f = || {
    // move `nums`
    let nums = nums;

    println!("{:?}", nums);
    println!("{:?}", s);
};

println!("{:?}", nums);
}</pre></p></div></div>
</div><div class="slide">
<h1 id="move-closure">Move closure</h1>
<p>Или с move closure:</p>
<div class="split-view" markdown="1"><div class="lhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> nums = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span>, <span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> s = <span class="tshl-operator">&amp;</span><span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;cookies&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> f = <span class="tshl-keyword">move</span> || {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, nums<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs">"cookies"</div></pre></p>
<p><pre class="rustc-source" data-sha="abedb9f61f7bd4ffbf5a3e739d4279a335b3bb1d">fn main() {
let nums = vec![0, 1, 2, 3];
let s = &String::from("cookies");

let f = move || {
    println!("{:?}", nums);
    println!("{:?}", s);
};

println!("{:?}", s);
}</pre></p></div>
<div class="rhs" markdown="1"><p>
                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> nums = <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span>, <span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span>, <span class="tshl-constant_builtin">3</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> s = <span class="tshl-operator">&amp;</span><span class="tshl-type">String</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;cookies&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> f = <span class="tshl-keyword">move</span> || {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, nums<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, s<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, nums<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                </p>
<p><pre><div class="rustc hljs"><span style="font-weight:bold;color:rgb(255,85,85)">error[E0382]</span><span style="font-weight:bold">: borrow of moved value: `nums`</span>
  <span style="font-weight:bold;color:rgb(85,85,255)">--&gt; </span>src/bin/main_b7a8fdf6144b10d7b7ab47e78a1d1fd812793364.rs:10:18
   <span style="font-weight:bold;color:rgb(85,85,255)">|</span>
<span style="font-weight:bold;color:rgb(85,85,255)">2</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>let nums = vec![0, 1, 2, 3];
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>    <span style="font-weight:bold;color:rgb(85,85,255)">----</span> <span style="font-weight:bold;color:rgb(85,85,255)">move occurs because `nums` has type `Vec&lt;i32&gt;`, which does not implement the `Copy` trait</span>
<span style="font-weight:bold;color:rgb(85,85,255)">...</span>
<span style="font-weight:bold;color:rgb(85,85,255)">5</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>let f = move || {
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>        <span style="font-weight:bold;color:rgb(85,85,255)">-------</span> <span style="font-weight:bold;color:rgb(85,85,255)">value moved into closure here</span>
<span style="font-weight:bold;color:rgb(85,85,255)">6</span>  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>    println!("{:?}", nums);
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>                     <span style="font-weight:bold;color:rgb(85,85,255)">----</span> <span style="font-weight:bold;color:rgb(85,85,255)">variable moved due to use in closure</span>
<span style="font-weight:bold;color:rgb(85,85,255)">...</span>
<span style="font-weight:bold;color:rgb(85,85,255)">10</span> <span style="font-weight:bold;color:rgb(85,85,255)">| </span>println!("{:?}", nums);
   <span style="font-weight:bold;color:rgb(85,85,255)">| </span>                 <span style="font-weight:bold;color:rgb(255,85,85)">^^^^</span> <span style="font-weight:bold;color:rgb(255,85,85)">value borrowed here after move</span>

<span style="font-weight:bold">For more information about this error, try `rustc --explain E0382`.</span>
<span style="font-weight:bold;color:rgb(255,85,85)">error</span><span style="font-weight:bold">:</span> could not compile `rust` due to previous error</div></pre></p>
<p><pre class="rustc-source" data-sha="b7a8fdf6144b10d7b7ab47e78a1d1fd812793364">fn main() {
let nums = vec![0, 1, 2, 3];
let s = &String::from("cookies");

let f = move || {
    println!("{:?}", nums);
    println!("{:?}", s);
};

println!("{:?}", nums);
}</pre></p></div></div>
</div><div class="slide">
<h1 id="disjoint-capture">Disjoint capture</h1>
<p>Ако имаме някакви композитни данни като структура или кортеж, тогава Rust позволява да се прихванат само част от данните.</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="b08fd06a0a10149a24c399bff0cec700677fbfd9">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> x = <span class="tshl-punctuation_bracket">(</span><span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">]</span>, <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> c = <span class="tshl-keyword">move</span> || {
    <span class="tshl-comment">// Само `x.0` се прихваща</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, x.<span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}<span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="b08fd06a0a10149a24c399bff0cec700677fbfd9">#![allow(unused_variables)]
fn main() {
let x = (vec![0], vec![0]);
let c = move || {
    // Само `x.0` се прихваща
    println!("{:?}", x.0);
};
}</pre>
</div><div class="slide">
<h1 id="disjoint-capture">Disjoint capture</h1>
<p>Може да накараме компилатора да прихване цялата стойност с присвояване.</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="b9fde6fe39bca5b250b8ef0e3a564eedb2fe74ca">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> x = <span class="tshl-punctuation_bracket">(</span><span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">]</span>, <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">let</span> c = <span class="tshl-keyword">move</span> || {
    <span class="tshl-keyword">let</span> _ = <span class="tshl-operator">&amp;</span>x<span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, x.<span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}<span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="b9fde6fe39bca5b250b8ef0e3a564eedb2fe74ca">#![allow(unused_variables)]
fn main() {
let x = (vec![0], vec![0]);
let c = move || {
    let _ = &x;

    println!("{:?}", x.0);
};
}</pre>
</div><div class="slide">
<h1 id="drop-order">Drop order</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="c6bc84421e0c0dd2de065655204e0c75f91f1583">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</div>
                        <pre><code class="rustrust language-rust hljs">{
    <span class="tshl-keyword">let</span> x = <span class="tshl-punctuation_bracket">(</span><span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">]</span>, <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

    {
        <span class="tshl-keyword">let</span> c = || {
            <span class="tshl-comment">// Rust 2018 прихваща цялата `x`</span>
            <span class="tshl-comment">// Rust 2021 прихваща само `x.0`</span>
            <span class="tshl-function">move_value</span><span class="tshl-punctuation_bracket">(</span>x<span class="tshl-punctuation_delimiter">.</span><span class="tshl-constant_builtin">0</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
        }<span class="tshl-punctuation_delimiter">;</span>

        <span class="tshl-comment">// В Rust 2018 `c` и `x` се дропват на края на блока.</span>
        <span class="tshl-comment">// В Rust 2021 `c` и `x.0` се дропват на края на блока.</span>
    }

    <span class="tshl-comment">// В Rust 2018 стойността на `x` е преместена, затова не се дропва тук.</span>
    <span class="tshl-comment">// В Rust 2021 стойността на `x.0` е била дропната,</span>
    <span class="tshl-comment">// но стойносттна на `x.1` се дропва тук.</span>
}</code></pre>
                    </div>
                    
                </div>
                
<pre class="rustc-source" data-sha="c6bc84421e0c0dd2de065655204e0c75f91f1583">#![allow(unused_variables)]
fn move_value<T>(val: T) {}
fn main() {
{
    let x = (vec![0], vec![0]);

    {
        let c = || {
            // Rust 2018 прихваща цялата `x`
            // Rust 2021 прихваща само `x.0`
            move_value(x.0);
        };

        // В Rust 2018 `c` и `x` се дропват на края на блока.
        // В Rust 2021 `c` и `x.0` се дропват на края на блока.
    }

    // В Rust 2018 стойността на `x` е преместена, затова не се дропва тук.
    // В Rust 2021 стойността на `x.0` е била дропната,
    // но стойносттна на `x.1` се дропва тук.
}
}</pre>
</div><div class="slide">
<h1 id="fn-traits">Fn traits</h1>
<ul>
<li><code>Fn</code></li>
<li><code>FnMut</code></li>
<li><code>FnOnce</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<ul>
<li><code>Fn</code></li>
<li><code>FnMut</code></li>
<li><code>FnOnce</code></li>
</ul>
<p>Имат специален синтаксис, например</p>
<ul>
<li><code>Fn()</code></li>
<li><code>FnMut(u32, u32) -&gt; bool</code></li>
<li><code>FnOnce() -&gt; String</code></li>
</ul>
</div><div class="slide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnonce">FnOnce</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_once</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnonce">FnOnce</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_once</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>self</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnonce">FnOnce</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_once</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>self</code></li>
<li>може да се извика само веднъж</li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnonce">FnOnce</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">type</span> <span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_once</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>self</code></li>
<li>може да се извика само веднъж</li>
<li>в комбинация с move closure може да се използва за прехвърляне на собственост</li>
</ul>
</div><div class="slide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnmut">FnMut</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnMut</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_mut</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnmut">FnMut</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnMut</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_mut</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>&amp;mut self</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fnmut">FnMut</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">FnMut</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call_mut</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>&amp;mut self</code></li>
<li>може да се вика множество пъти и да се променят прихванатите стойност</li>
</ul>
</div><div class="slide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fn">Fn</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">Fn</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">FnMut</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fn">Fn</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">Fn</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">FnMut</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>&amp;self</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<h3 id="fn">Fn</h3>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-comment">// опростено</span>
<span class="tshl-keyword">trait</span> <span class="tshl-type">Fn</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span>: <span class="tshl-type">FnMut</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">call</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-operator">&amp;</span><span class="tshl-variable_builtin">self</span>, <span class="tshl-variable_parameter">args</span>: <span class="tshl-type">Args</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-constructor">Self</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Output</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
<ul>
<li><code>&amp;self</code></li>
<li>може да се вика множество пъти, но не могат да се променят прихванатите стойност</li>
</ul>
</div><div class="slide">
<h1 id="fn-traits">Fn traits</h1>
<p>Когато създадем closure, компилатора имплементира всички trait-ове, които може</p>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<p>Когато създадем closure, компилатора имплементира всички trait-ове, които може</p>
<ul>
<li>(<code>&amp;</code>): <code>FnOnce</code> + <code>FnMut</code> + <code>Fn</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<p>Когато създадем closure, компилатора имплементира всички trait-ове, които може</p>
<ul>
<li>(<code>&amp;</code>): <code>FnOnce</code> + <code>FnMut</code> + <code>Fn</code></li>
<li>(<code>&amp;mut</code>): <code>FnOnce</code> + <code>FnMut</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<p>Когато създадем closure, компилатора имплементира всички trait-ове, които може</p>
<ul>
<li>(<code>&amp;</code>): <code>FnOnce</code> + <code>FnMut</code> + <code>Fn</code></li>
<li>(<code>&amp;mut</code>): <code>FnOnce</code> + <code>FnMut</code></li>
<li>(ownership): <code>FnOnce</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<p>Когато създадем closure, компилатора имплементира всички trait-ове, които може</p>
<ul>
<li>(<code>&amp;</code>): <code>FnOnce</code> + <code>FnMut</code> + <code>Fn</code></li>
<li>(<code>&amp;mut</code>): <code>FnOnce</code> + <code>FnMut</code></li>
<li>(ownership): <code>FnOnce</code></li>
<li>Не можем да имаме само <code>Fn</code> или <code>FnMut</code> заради ограниченията на трейтовете</li>
</ul>
</div><div class="slide subslide">
<h1 id="fn-traits">Fn traits</h1>
<p>Когато създадем closure, компилатора имплементира всички trait-ове, които може</p>
<ul>
<li>(<code>&amp;</code>): <code>FnOnce</code> + <code>FnMut</code> + <code>Fn</code></li>
<li>(<code>&amp;mut</code>): <code>FnOnce</code> + <code>FnMut</code></li>
<li>(ownership): <code>FnOnce</code></li>
<li>Не можем да имаме само <code>Fn</code> или <code>FnMut</code> заради ограниченията на трейтовете</li>
<li>Ако това ви се струва странно, може да го мислите като ограниченията при взимане на референция <code>let x = ...</code> → <code>&amp;mut x</code> → <code>&amp;x</code></li>
</ul>
</div><div class="slide">
<h1 id="taking-closures">Taking closures</h1>
<p>По-популярния начин за взимане на closure е чрез static dispatch</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">eval_and_increment</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">F</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">f</span>: <span class="tshl-type">F</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> <span class="tshl-keyword">where</span> <span class="tshl-type">F</span>: <span class="tshl-type">Fn</span>???<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> {
    <span class="tshl-function">f</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + <span class="tshl-constant_builtin">1</span>
}

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, eval_and_increment<span class="tshl-punctuation_bracket">(</span>|| <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="taking-closures">Taking closures</h1>
<p>Кой Fn trait да сложим за ограничение?</p>
<table>
<thead>
<tr>
<th id="тип">Тип</th>
<th id="прихващане_на_стойности">Прихващане на стойности</th>
<th id="брой_викания">Брой викания</th>
<th id="кога?">Кога?</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FnOnce</code></td>
<td>може да местим, променяме и четем стойности</td>
<td>веднъж</td>
<td>move closures</td>
</tr>
<tr>
<td><code>FnMut</code></td>
<td>може да променяме и четем стойности</td>
<td>множество пъти</td>
<td>викане множество пъти</td>
</tr>
<tr>
<td><code>Fn</code></td>
<td>може да четем стойности</td>
<td>множество пъти</td>
<td>когато не можем да прихванем <code>&amp;mut</code> референция</td>
</tr>
</tbody>
</table>
</div><div class="slide subslide">
<h1 id="taking-closures">Taking closures</h1>
<p>Кой Fn trait да сложим за ограничение?</p>
<table>
<thead>
<tr>
<th id="тип">Тип</th>
<th id="прихващане_на_стойности">Прихващане на стойности</th>
<th id="брой_викания">Брой викания</th>
<th id="кога?">Кога?</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FnOnce</code></td>
<td>може да местим, променяме и четем стойности</td>
<td>веднъж</td>
<td>move closures</td>
</tr>
<tr>
<td><code>FnMut</code></td>
<td>може да променяме и четем стойности</td>
<td>множество пъти</td>
<td>викане множество пъти</td>
</tr>
<tr>
<td><code>Fn</code></td>
<td>може да четем стойности</td>
<td>множество пъти</td>
<td>когато не можем да прихванем <code>&amp;mut</code> референция</td>
</tr>
</tbody>
</table>
<p>или пробваме в този ред докато компилаторът ни разреши 😉</p>
</div><div class="slide">
<h1 id="taking-closures">Taking closures</h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="08f09035352c93cb0d3106fae03dafd61360c360">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">eval_and_increment</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">F</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">f</span>: <span class="tshl-type">F</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> <span class="tshl-keyword">where</span> <span class="tshl-type">F</span>: <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> {
    <span class="tshl-function">f</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + <span class="tshl-constant_builtin">1</span>
}

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, eval_and_increment<span class="tshl-punctuation_bracket">(</span>|| <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">2</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="08f09035352c93cb0d3106fae03dafd61360c360">fn eval_and_increment<F>(f: F) -> usize where F: FnOnce() -> usize {
    f() + 1
}

fn main() {
println!("{}", eval_and_increment(|| 1));
}</pre>
</div><div class="slide">
<h1 id="taking-closures">Taking closures</h1>
<p>Ако closure не прихваща нищо, той се свежда до функция</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="153cb8bb885c040b16cbc35693dd24c47ab9d4ff">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">eval_and_increment</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">f</span>: <span class="tshl-keyword">fn</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> {
    <span class="tshl-function">f</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + <span class="tshl-constant_builtin">1</span>
}

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, eval_and_increment<span class="tshl-punctuation_bracket">(</span>|| <span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">2</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="153cb8bb885c040b16cbc35693dd24c47ab9d4ff">fn eval_and_increment(f: fn() -> usize) -> usize {
    f() + 1
}

fn main() {
println!("{}", eval_and_increment(|| 1));
}</pre>
</div><div class="slide">
<h1 id="taking-closures">Taking closures</h1>
<p>Може да подаваме функции, където се очаква closure</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="29f89ed0cdd9c859f01075457798622f18b690ec">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">one</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> {
    <span class="tshl-constant_builtin">1</span>
}

<span class="tshl-keyword">fn</span> <span class="tshl-function">eval_and_increment</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">F</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">f</span>: <span class="tshl-type">F</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> <span class="tshl-keyword">where</span> <span class="tshl-type">F</span>: <span class="tshl-type">FnOnce</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">usize</span> {
    <span class="tshl-function">f</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> + <span class="tshl-constant_builtin">1</span>
}

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, eval_and_increment<span class="tshl-punctuation_bracket">(</span>one<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">2</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="29f89ed0cdd9c859f01075457798622f18b690ec">fn one() -> usize {
    1
}

fn eval_and_increment<F>(f: F) -> usize where F: FnOnce() -> usize {
    f() + 1
}

fn main() {
println!("{}", eval_and_increment(one));
}</pre>
</div><div class="slide">
<h1 id="returning-closures">Returning closures</h1>
<h3 id="impl-trait">impl Trait</h3>
<p>Не знаем типа на closure-a тъй като се генерира при компилиране, съответно това е един начин за връщане на closure</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="1df18e5f057069ed754f0454a668023a90c3b734">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">curry</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">a</span>: <span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-keyword">impl</span> <span class="tshl-type">Fn</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-type_builtin">u32</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-type_builtin">u32</span> {
    <span class="tshl-keyword">move</span> |b| a + b
}

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, curry<span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">2</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">3</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="1df18e5f057069ed754f0454a668023a90c3b734">fn curry(a: u32) -> impl Fn(u32) -> u32 {
    move |b| a + b
}

fn main() {
println!("{}", curry(1)(2));
}</pre>
</div><div class="slide">
<h1 id="impl-trait">impl Trait</h1>
<p>Може да стои на мястото на типа на аргумент или return типа</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="6c2f39fa96e49c36b365910c82aa168f1383fecf">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>fmt<span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">Debug</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">fn</span> <span class="tshl-function">id</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">arg</span>: <span class="tshl-keyword">impl</span> <span class="tshl-type">Debug</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-keyword">impl</span> <span class="tshl-type">Debug</span> {
    arg
}
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, id<span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, id<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;foo&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">1
"foo"</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="6c2f39fa96e49c36b365910c82aa168f1383fecf">use std::fmt::Debug;

fn id(arg: impl Debug) -> impl Debug {
    arg
}
fn main() {
println!("{:?}", id(1));
println!("{:?}", id("foo"));
}</pre>
</div><div class="slide">
<h1 id="impl-trait">impl Trait</h1>
<p>Не може да правите нищо друго с него освен това което имплементира</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="8bf7039ea5b999af5f79cbab4e653a034da9476d">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>fmt<span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">Debug</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">fn</span> <span class="tshl-function">id</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-variable_parameter">arg</span>: <span class="tshl-keyword">impl</span> <span class="tshl-type">Debug</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-keyword">impl</span> <span class="tshl-type">Debug</span> {
    arg
}
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, id<span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">1</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs"><span style="font-weight:bold;color:rgb(255,85,85)">error[E0277]</span><span style="font-weight:bold">: `impl Debug` doesn't implement `std::fmt::Display`</span>
 <span style="font-weight:bold;color:rgb(85,85,255)">--&gt; </span>src/bin/main_8bf7039ea5b999af5f79cbab4e653a034da9476d.rs:7:16
  <span style="font-weight:bold;color:rgb(85,85,255)">|</span>
<span style="font-weight:bold;color:rgb(85,85,255)">7</span> <span style="font-weight:bold;color:rgb(85,85,255)">| </span>println!("{}", id(1));
  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>               <span style="font-weight:bold;color:rgb(255,85,85)">^^^^^</span> <span style="font-weight:bold;color:rgb(255,85,85)">`impl Debug` cannot be formatted with the default formatter</span>
  <span style="font-weight:bold;color:rgb(85,85,255)">|</span>
  <span style="font-weight:bold;color:rgb(85,85,255)">= </span><span style="font-weight:bold">help</span>: the trait `std::fmt::Display` is not implemented for `impl Debug`
  <span style="font-weight:bold;color:rgb(85,85,255)">= </span><span style="font-weight:bold">note</span>: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
  <span style="font-weight:bold;color:rgb(85,85,255)">= </span><span style="font-weight:bold">note</span>: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)

<span style="font-weight:bold">For more information about this error, try `rustc --explain E0277`.</span>
<span style="font-weight:bold;color:rgb(255,85,85)">error</span><span style="font-weight:bold">:</span> could not compile `rust` due to previous error</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="8bf7039ea5b999af5f79cbab4e653a034da9476d">use std::fmt::Debug;

fn id(arg: impl Debug) -> impl Debug {
    arg
}
fn main() {
println!("{}", id(1));
}</pre>
</div><div class="slide">
<h1 id="impl-trait">impl Trait</h1>
<p>Удобно е за връщане на итератори</p>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="700005503dc27f201bc916b9cccfeb8a0eb72d3c">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>fmt<span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">Debug</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">fn</span> <span class="tshl-function">create_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> -&gt; <span class="tshl-keyword">impl</span> <span class="tshl-type">Iterator</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">Item</span> = <span class="tshl-keyword">impl</span> <span class="tshl-type">Debug</span><span class="tshl-punctuation_bracket">&gt;</span> {
    <span class="tshl-function_macro">vec</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">[</span><span class="tshl-constant_builtin">0</span>, <span class="tshl-constant_builtin">1</span>, <span class="tshl-constant_builtin">2</span><span class="tshl-punctuation_bracket">]</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">into_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">map</span><span class="tshl-punctuation_bracket">(</span>|x| x <span class="tshl-operator">*</span> <span class="tshl-constant_builtin">2</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">enumerate</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
}

<span class="tshl-keyword">fn</span> <span class="tshl-function">main</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-keyword">for</span> x <span class="tshl-keyword">in</span> <span class="tshl-function">create_iter</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
        <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, x<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    }
}</code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">(0, 0)
(1, 2)
(2, 4)</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="700005503dc27f201bc916b9cccfeb8a0eb72d3c">use std::fmt::Debug;

fn create_iter() -> impl Iterator<Item = impl Debug> {
    vec![0, 1, 2].into_iter().map(|x| x * 2).enumerate()
}

fn main() {
    for x in create_iter() {
        println!("{:?}", x);
    }
}</pre>
</div><div class="slide">
<h1 id="impl-trait">impl Trait</h1>
<p>Разликата между <code>generics</code> и <code>impl Trait</code></p>
<ul>
<li>generics поддържа turbofish синтаксис и изисква да се пише задължително при функция като <code>f&lt;T&gt;() -&gt; T</code></li>
<li>impl Trait оставя компилатора да оправи типа включително и като return тип, но не може да използваме turbofish при извикване на функцията</li>
</ul>
</div><div class="slide">
<h1 id="въпроси">Въпроси</h1>
</div>
    </main>
</body>
</html>
